(()=>{"use strict";var a={d:(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o:(a,e)=>Object.prototype.hasOwnProperty.call(a,e)};function e(a){return!!a||(v.classList.remove("d-none"),v.innerHTML="Data is not loaded yet. Please wait.",!1)}a.d({},{E8:()=>f,Wm:()=>v,hF:()=>w});const n="4e55739b055c960d82d39fac4c387f82";async function t(a,e,n=5,m=1e3){if(!a)return console.log(`Waiting ${m/1e3} seconds before retrying...`),await new Promise((a=>setTimeout(a,m))),t(a,e,n-1,2*m);try{const a=await fetch(e);if(!a.ok)throw new Error(`HTTP Error: ${a.status}`);return{data:await a.json()}}catch(o){return n>0?(console.log(`Retrying in ${m/1e3} seconds... (${n} attempts left)`),await new Promise((a=>setTimeout(a,m))),t(a,e,n-1,2*m)):(console.log("Max retries reached. Giving up."),!1)}}function m(a){return a.replace(/\b\w/g,(a=>a.toUpperCase()))}function o(a){const e=new Date(1e3*a);return{year:e.getUTCFullYear(),month:e.getUTCMonth(),date:e.getUTCDate(),day:e.getUTCDay()}}function i(a){const{year:e,month:n,date:t}=o(a.list[0].dt);return function(a,e){const n=Math.floor(a.getTime()/1e3),t=e.reduce(((a,e,t,m)=>(Math.abs(e.dt-n)<Math.abs(m[a].dt-n)&&(a=t),a)),0);return e.slice(t).filter(((a,e)=>{if(e%8==0)return a}))}(function(a,e,n,t){const m=new Date(Date.UTC(e,n,t,12,0,0));return m.setTime(m.getTime()-1e3*a),m}(a.city.timezone,e,n,t),a.list)}const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=document.getElementById("wx");async function c(){var a;l.innerHTML="",await u(function(a){const{weather:e,main:n,name:t}=a.weather;return{icon:e[0].icon,cityName:t,description:m(e[0].description),temperature:n.temp}}(p),'<div class="card mb-3 mx-auto"> <div class="row g-0"> <div class="col-md-4 d-flex justify-content-center align-items-center"> <img src="https://openweathermap.org/img/wn/{{icon}}@2x.png" class="img-fluid" alt="..."/> </div> <div class="col-md-8"> <div class="card-body"> <h4 class="card-title">{{cityName}}</h4> <h5 class="card-title">Current Weather</h5> <p class="card-text">{{description}}</p> <p class="card-text">{{temperature}} °C (Celsius)</p> </div> </div> </div> </div> '),await u((a=p,{forecast:a.forecast.reduce(((a,e)=>{const{_:n,month:t,day:i,date:l}=o(e.dt),c=`${r[i]}, ${s[t]} ${l}`;return a.push({icon:e.weather[0].icon,dateString:c,description:m(e.weather[0].description),temperature:e.main.temp}),a}),[])}),'<div> <button class="btn btn-primary mb-3" type="button" aria-expanded="false" aria-controls="collapseForecast" id="collapseBtn"> Show Forecast </button> <button class="btn btn-primary ms-2 mb-3" type="button" aria-controls="setDefault" id="setDefault"> Set Default </button> <button class="btn btn-secondary ms-2 mb-3" type="button" aria-controls="clearDefault" id="clearDefault"> Clear Default </button> <div class="card card-body d-none" id="collapseEl"> <div class="container text-center"> <div class="row"> {{for forecast}} <div class="col"> <img src="https://openweathermap.org/img/wn/{{icon}}@2x.png" class="img-fluid" alt="..."/> <h5 class="card-title">{{dateString}}</h5> <p class="card-text">{{description}}</p> <p class="card-text">{{temperature}} °C (Celsius)</p> </div> {{end for}} </div> </div> </div> </div> '),function(){const a=document.getElementById("collapseEl"),e=document.getElementById("collapseBtn");e.addEventListener("click",(()=>{a.classList.contains("d-none")?(a.classList.remove("d-none"),e.innerHTML="Hide Forecast",e.setAttribute("aria-expanded","true")):(a.classList.add("d-none"),e.innerHTML="Show Forecast",e.setAttribute("aria-expanded","false"))}))}(),document.getElementById("setDefault").addEventListener("click",(()=>{const{coord:a,name:e}=p.weather;var n,t;n=a,t=e,localStorage.setItem("latLon",JSON.stringify(n)),function(a){const e=document.getElementById("liveToast");e.querySelector(".toast-body").innerHTML=a,bootstrap.Toast.getOrCreateInstance(e).show()}(`${t} added as default.`)})),document.getElementById("clearDefault").addEventListener("click",(()=>{localStorage.clear(),y()}))}async function u(a,e){!function(a,e){e.insertAdjacentHTML("beforeend",a)}(function(a,e){for(const n in a)if(Array.isArray(a[n])){const t=`{{for ${n}}}`,m="{{end for}}",o=e.indexOf(t),i=e.indexOf(m,o+1);function r(){return e.slice(0,o)+a[n].reduce(((a,n)=>{let r=e.substring(o,i+m.length+1).replace(t,"").replace(m,"");for(const a in n)r=r.replace(`{{${a}}}`,n[a]);return a+r}),"")+e.slice(i+m.length+1)}e=r()}else e=e.replace(`{{${n}}}`,a[n]);return e}(a,e),l)}const d=document.getElementById("search"),g=document.getElementById("dropdown");async function h(){try{const a=await t(!0,"https://ipapi.co/json/");b({lat:a.data.latitude,lon:a.data.longitude})}catch(a){console.error("Error fetching IP-based location:",a)}}let p;async function b(a=w.value.toLowerCase()){if(dropdown.classList.add("d-none"),"string"==typeof a){const o=function(a,n){if(!e(a))return!1;const t=a.find((a=>a.name.toLowerCase().includes(n.toLowerCase())));return t?(w.value=t.name,t.name):(w.classList.add("is-invalid"),w.classList.remove("is-valid"),!1)}(f,a);o&&(await m(await async function(a){const e=await t(a,`https://api.openweathermap.org/geo/1.0/direct?q=${a}&limit=1&appid=${n}`);return{lat:e.data[0].lat,lon:e.data[0].lon}}(o)),c())}else"object"==typeof a&&(await m(a),c());async function m(a){p=await async function(a){let{lat:e,lon:m}=a;e=e.toFixed(2),m=m.toFixed(2);const o=await t(a,`https://api.openweathermap.org/data/2.5/weather?lat=${e}&lon=${m}&units=metric&appid=${n}`),r=await t(a,`https://api.openweathermap.org/data/2.5/forecast?lat=${e}&lon=${m}&units=metric&appid=${n}`);return{weather:o.data,forecast:i(r.data),timezone:r.data.city.timezone}}(a)}w.value=""}function y(){const a=JSON.parse(localStorage.getItem("latLon"));a?b(a):function(){if(!("geolocation"in navigator))return h();navigator.geolocation.getCurrentPosition((a=>b({lat:a.coords.latitude,lon:a.coords.longitude})),h,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}()}const f=JSON.parse('[{"name":"Abidjan"},{"name":"Abu Dhabi"},{"name":"Abuja"},{"name":"Accra"},{"name":"Addis Ababa"},{"name":"Ahmedabad"},{"name":"Aleppo"},{"name":"Alexandria"},{"name":"Algiers"},{"name":"Almaty"},{"name":"Amman"},{"name":"Amsterdam"},{"name":"Anchorage"},{"name":"Andorra la Vella"},{"name":"Ankara"},{"name":"Antananarivo"},{"name":"Apia"},{"name":"Arnold"},{"name":"Ashgabat"},{"name":"Asmara"},{"name":"Asuncion"},{"name":"Athens"},{"name":"Auckland"},{"name":"Avarua"},{"name":"Baghdad"},{"name":"Baku"},{"name":"Bamako"},{"name":"Banda Aceh"},{"name":"Bandar Seri Begawan"},{"name":"Bandung"},{"name":"Bangkok"},{"name":"Bangui"},{"name":"Banjul"},{"name":"Barcelona"},{"name":"Barranquilla"},{"name":"Basrah"},{"name":"Basse-Terre"},{"name":"Basseterre"},{"name":"Beijing"},{"name":"Beirut"},{"name":"Bekasi"},{"name":"Belem"},{"name":"Belgrade"},{"name":"Belmopan"},{"name":"Belo Horizonte"},{"name":"Bengaluru"},{"name":"Berlin"},{"name":"Bern"},{"name":"Bishkek"},{"name":"Bissau"},{"name":"Bogota"},{"name":"Brasilia"},{"name":"Bratislava"},{"name":"Brazzaville"},{"name":"Bridgetown"},{"name":"Brisbane"},{"name":"Brussels"},{"name":"Bucharest"},{"name":"Budapest"},{"name":"Buenos Aires"},{"name":"Bujumbura"},{"name":"Bursa"},{"name":"Busan"},{"name":"Cairo"},{"name":"Cali"},{"name":"Caloocan"},{"name":"Camayenne"},{"name":"Canberra"},{"name":"Cape Town"},{"name":"Caracas"},{"name":"Casablanca"},{"name":"Castries"},{"name":"Cayenne"},{"name":"Charlotte Amalie"},{"name":"Chengdu"},{"name":"Chennai"},{"name":"Chicago"},{"name":"Chisinau"},{"name":"Chittagong"},{"name":"Chongqing"},{"name":"Colombo"},{"name":"Conakry"},{"name":"Copenhagen"},{"name":"Cordoba"},{"name":"Curitiba"},{"name":"Daegu"},{"name":"Daejeon"},{"name":"Dakar"},{"name":"Dallas"},{"name":"Damascus"},{"name":"Dar es Salaam"},{"name":"Delhi"},{"name":"Denver"},{"name":"Dhaka"},{"name":"Dili"},{"name":"Djibouti"},{"name":"Dodoma"},{"name":"Doha"},{"name":"Dongguan"},{"name":"Douala"},{"name":"Douglas"},{"name":"Dubai"},{"name":"Dublin"},{"name":"Durban"},{"name":"Dushanbe"},{"name":"Faisalabad"},{"name":"Fort-de-France"},{"name":"Fortaleza"},{"name":"Freetown"},{"name":"Fukuoka"},{"name":"Funafuti"},{"name":"Gaborone"},{"name":"George Town"},{"name":"Georgetown"},{"name":"Gibraltar"},{"name":"Gitega"},{"name":"Giza"},{"name":"Guadalajara"},{"name":"Guangzhou"},{"name":"Guatemala City"},{"name":"Guayaquil"},{"name":"Gujranwala"},{"name":"Gustavia"},{"name":"Gwangju"},{"name":"Hamburg"},{"name":"Hanoi"},{"name":"Harare"},{"name":"Havana"},{"name":"Helsinki"},{"name":"Ho Chi Minh City"},{"name":"Hong Kong"},{"name":"Honiara"},{"name":"Honolulu"},{"name":"Houston"},{"name":"Hyderabad"},{"name":"Hyderabad"},{"name":"Ibadan"},{"name":"Incheon"},{"name":"Isfahan"},{"name":"Islamabad"},{"name":"Istanbul"},{"name":"Izmir"},{"name":"Jaipur"},{"name":"Jakarta"},{"name":"Jeddah"},{"name":"Jerusalem"},{"name":"Johannesburg"},{"name":"Juarez"},{"name":"Juba"},{"name":"Kabul"},{"name":"Kaduna"},{"name":"Kampala"},{"name":"Kano"},{"name":"Kanpur"},{"name":"Kaohsiung"},{"name":"Karachi"},{"name":"Karaj"},{"name":"Kathmandu"},{"name":"Kawasaki"},{"name":"Kharkiv"},{"name":"Khartoum"},{"name":"Khulna"},{"name":"Kigali"},{"name":"Kingsburg"},{"name":"Kingston"},{"name":"Kingstown"},{"name":"Kinshasa"},{"name":"Kobe"},{"name":"Kolkata"},{"name":"Kota Bharu"},{"name":"Kowloon"},{"name":"Kuala Lumpur"},{"name":"Kumasi"},{"name":"Kuwait"},{"name":"Kyiv"},{"name":"Kyoto"},{"name":"La Paz"},{"name":"Lagos"},{"name":"Lahore"},{"name":"Libreville"},{"name":"Lilongwe"},{"name":"Lima"},{"name":"Lisbon"},{"name":"Ljubljana"},{"name":"Lome"},{"name":"London"},{"name":"Los Angeles"},{"name":"Luanda"},{"name":"Lubumbashi"},{"name":"Lusaka"},{"name":"Luxembourg"},{"name":"Macau"},{"name":"Madrid"},{"name":"Majuro"},{"name":"Makassar"},{"name":"Malabo"},{"name":"Male"},{"name":"Mamoudzou"},{"name":"Managua"},{"name":"Manama"},{"name":"Manaus"},{"name":"Manila"},{"name":"Maputo"},{"name":"Maracaibo"},{"name":"Maracay"},{"name":"Mariehamn"},{"name":"Marigot"},{"name":"Maseru"},{"name":"Mashhad"},{"name":"Mbabane"},{"name":"Mecca"},{"name":"Medan"},{"name":"Medellin"},{"name":"Medina"},{"name":"Melbourne"},{"name":"Mexico City"},{"name":"Miami"},{"name":"Minsk"},{"name":"Mogadishu"},{"name":"Monaco"},{"name":"Monrovia"},{"name":"Montevideo"},{"name":"Montreal"},{"name":"Moroni"},{"name":"Moscow"},{"name":"Mosul"},{"name":"Multan"},{"name":"Mumbai"},{"name":"Muscat"},{"name":"N\'Djamena"},{"name":"Nagoya"},{"name":"Nairobi"},{"name":"Nanchong"},{"name":"Nanjing"},{"name":"Nassau"},{"name":"Nay Pyi Taw"},{"name":"New York"},{"name":"Niamey"},{"name":"Nicosia"},{"name":"Nouakchott"},{"name":"Noumea"},{"name":"Novosibirsk"},{"name":"Nuku\'alofa"},{"name":"Nur-Sultan"},{"name":"Nuuk"},{"name":"Oranjestad"},{"name":"Osaka"},{"name":"Oslo"},{"name":"Ottawa"},{"name":"Ouagadougou"},{"name":"Pago Pago"},{"name":"Palembang"},{"name":"Palo Alto"},{"name":"Panama"},{"name":"Papeete"},{"name":"Paramaribo"},{"name":"Paris"},{"name":"Perth"},{"name":"Philadelphia"},{"name":"Phnom Penh"},{"name":"Phoenix"},{"name":"Podgorica"},{"name":"Port Louis"},{"name":"Port Moresby"},{"name":"Port of Spain"},{"name":"Port-Vila"},{"name":"Port-au-Prince"},{"name":"Porto Alegre"},{"name":"Porto-Novo"},{"name":"Prague"},{"name":"Praia"},{"name":"Pretoria"},{"name":"Pristina"},{"name":"Puebla"},{"name":"Pune"},{"name":"Pyongyang"},{"name":"Quezon City"},{"name":"Quito"},{"name":"Rabat"},{"name":"Rawalpindi"},{"name":"Recife"},{"name":"Reykjavik"},{"name":"Riga"},{"name":"Rio de Janeiro"},{"name":"Riyadh"},{"name":"Road Town"},{"name":"Rome"},{"name":"Roseau"},{"name":"Saint George\'s"},{"name":"Saint Helier"},{"name":"Saint John\'s"},{"name":"Saint Peter Port"},{"name":"Saint Petersburg"},{"name":"Saint-Denis"},{"name":"Saint-Pierre"},{"name":"Saipan"},{"name":"Salvador"},{"name":"San Antonio"},{"name":"San Diego"},{"name":"San Francisco"},{"name":"San Jose"},{"name":"San Juan"},{"name":"San Marino"},{"name":"San Salvador"},{"name":"Sanaa"},{"name":"Santa Cruz de la Sierra"},{"name":"Santiago"},{"name":"Santo Domingo"},{"name":"Sao Paulo"},{"name":"Sao Tome"},{"name":"Sapporo"},{"name":"Sarajevo"},{"name":"Seattle"},{"name":"Semarang"},{"name":"Seoul"},{"name":"Shanghai"},{"name":"Sharjah"},{"name":"Shenzhen"},{"name":"Singapore"},{"name":"Skopje"},{"name":"Sofia"},{"name":"South Tangerang"},{"name":"Soweto"},{"name":"Stockholm"},{"name":"Sucre"},{"name":"Surabaya"},{"name":"Surat"},{"name":"Suva"},{"name":"Sydney"},{"name":"Tabriz"},{"name":"Taipei"},{"name":"Tallinn"},{"name":"Tangerang"},{"name":"Tarawa"},{"name":"Tashkent"},{"name":"Tbilisi"},{"name":"Tegucigalpa"},{"name":"Tehran"},{"name":"Tel Aviv"},{"name":"Thimphu"},{"name":"Tianjin"},{"name":"Tijuana"},{"name":"Tirana"},{"name":"Tokyo"},{"name":"Toronto"},{"name":"Torshavn"},{"name":"Tripoli"},{"name":"Tunis"},{"name":"Ulan Bator"},{"name":"Vaduz"},{"name":"Valencia"},{"name":"Valletta"},{"name":"Vancouver"},{"name":"Victoria"},{"name":"Vienna"},{"name":"Vientiane"},{"name":"Vilnius"},{"name":"Warsaw"},{"name":"Washington"},{"name":"Wellington"},{"name":"Willemstad"},{"name":"Windhoek"},{"name":"Wuhan"},{"name":"Xi\'an"},{"name":"Yamoussoukro"},{"name":"Yangon"},{"name":"Yaounde"},{"name":"Yekaterinburg"},{"name":"Yerevan"},{"name":"Yokohama"},{"name":"Zagreb"}]'),w=document.getElementById("search"),v=document.getElementById("dropdown"),S=document.getElementById("submit");!async function(){y()}(),w.addEventListener("input",(()=>function(){const a=w.value.toLowerCase();dropdown.innerHTML="",a?e(f)&&(function(a,e){return a.filter((a=>a.name.toLowerCase().includes(e))).slice(0,10)}(f,a).forEach((a=>{const e=document.createElement("tr"),n=document.createElement("td");e.setAttribute("style","cursor:pointer"),n.textContent=a.name,e.appendChild(n),e.addEventListener("click",(()=>{d.value=a.name,g.classList.add("d-none")})),g.appendChild(e)})),g.classList.remove("d-none"),w.classList.remove("is-invalid")):dropdown.classList.add("d-none")}())),w.addEventListener("keyup",(a=>"Enter"===a.key&&b())),S.addEventListener("click",(()=>b()))})();